name: ğŸŒ± Fork Promoter Updater

on:
  schedule:
    - cron: "0 2 * * 1"  # ë§¤ì£¼ ì›”ìš”ì¼ 02:00 UTC ìë™ ì‹¤í–‰
  workflow_dispatch:

permissions:
  contents: write

jobs:
  promote-fork:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ§­ Checkout
        uses: actions/checkout@v4

      - name: ğŸª¶ Setup Git identity
        run: |
          git config user.name "github-actions"
          git config user.email "actions@users.noreply.github.com"

      - name: ğŸŒŸ Ensure Fork Section in README
        run: |
          if ! grep -q "Fork this repository" README.md; then
            echo "ğŸ”§ Fork section not found. Appending now."
            cat <<'EOF' >> README.md

---

## ğŸ”§ Fork & Experiment

Want to test your own deterministic LTSS build?  
ğŸ‘‰ [**Fork this repository**](https://github.com/${{ github.repository }}/fork)  
and start from the `fork-lab` branch.

[![Fork this repo](https://img.shields.io/badge/Fork%20on-GitHub-brightgreen?logo=github)](https://github.com/${{ github.repository }}/fork)

---
EOF
          fi

          git add README.md
          git commit -m "ğŸŒ± Auto-update Fork section in README ($(date -u '+%Y-%m-%d'))" || echo "No changes to commit"
          git push origin main || echo "No changes pushed"
